<div class="container-box">
    <form [formGroup]="changePasswordForm">
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" formControlName="email" readonly class="form-control">
        </div>

        <div class="form-group">
            <label for="newPassword">New Password</label>
            <input type="password" id="newPassword" formControlName="newPassword" class="form-control">
            <small class="error text-danger" *ngIf="changePasswordForm.get('newPassword')?.touched && changePasswordForm.get('newPassword')?.invalid">
                Password must be at least 8 characters long, contain one uppercase letter, one lowercase letter, one number, and one special character.
            </small>
        </div>

        <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-control">
            <small class="error text-danger" *ngIf="changePasswordForm.get('confirmPassword')?.touched && changePasswordForm.get('newPassword')?.value !== changePasswordForm.get('confirmPassword')?.value">
                ðŸš¨ Passwords do not match!
            </small>
        </div>

        <button type="button" class="btn btn-primary mt-3" (click)="onChangePassword()">Submit</button>
    </form>
</div>
import { Component, OnInit } from '@angular/core';
import { TaServiceService } from '../../../services/tas/ta-service.service';
import { FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms';
import { ActivatedRoute } from '@angular/router';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'app-changepasswordta',
  imports: [ReactiveFormsModule,FormsModule,CommonModule],
  templateUrl: './changepasswordta.component.html',
  styleUrl: './changepasswordta.component.css',
})
export class ChangepasswordtaComponent implements OnInit {
  changePasswordForm!: FormGroup;

  constructor(private taService: TaServiceService, private fb: FormBuilder,private route:ActivatedRoute) {}

  ngOnInit(): void {
    this.initForm();
    this.fetchUserEmail();
  }

  initForm(): void {
    this.changePasswordForm = this.fb.group({
      email: [{ value: '', disabled: true }],
      newPassword: ['', [Validators.required, Validators.minLength(8)]],
      confirmPassword: ['', [Validators.required]],
    });
  }
  fetchUserEmail(): void {
  const taId = this.route.snapshot.paramMap.get('id'); // âœ… Fetch TA ID from URL
  if (taId) {
    this.taService.getTaById(+taId).subscribe((ta) => {
      this.changePasswordForm.patchValue({ email: ta.email }); // âœ… Autofill email
    });
  }
}
  onChangePassword(): void {
  if (this.changePasswordForm.valid) {
    const newPassword = this.changePasswordForm.get('newPassword')?.value; // âœ… Get password correctly
    const confirmPassword = this.changePasswordForm.get('confirmPassword')?.value;

    if (newPassword !== confirmPassword) {
      alert("Passwords do not match"); // âœ… Proper validation
      return;
    }

    const taId = this.route.snapshot.paramMap.get('id'); // âœ… Fetch TA ID dynamically
    if (taId) {
      this.taService.changePassword(+taId, newPassword).subscribe({
        next: () => alert('Password changed successfully'),
        error: () => alert('Error changing password'),
      });
    }
  }
}
}
.container-box {
    padding: 20px;
    border: 2px solid #0059ff;
    border-radius: 10px;
    background-color: #e9ecef;
    max-width: 650px;
    margin: auto;
    box-shadow: 0px 4px 8px rgba(117, 108, 108, 0.1);
}
