<div class="module-form">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading module data...</p>
    </div>
  
    <!-- Main Form -->
    <div *ngIf="!isLoading" class="form-container">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Edit Module</h2>
        <button 
          type="button" 
          class="btn btn-outline-secondary"
          (click)="onCancel()"
        >
          <i class="fas fa-arrow-left me-2"></i>Back
        </button>
      </div>
      
      <div class="form-content">
        <div class="form-row">
          <div class="form-group">
            <label for="moduleName">
              Module Name <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="moduleName" 
              [(ngModel)]="moduleData.name"
              placeholder="Enter Module Name"
              class="form-control"
              required
            >
          </div>
          
          <div class="form-group">
            <label for="duration">
              Duration <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="duration" 
              [(ngModel)]="moduleData.duration"
              placeholder="Enter Duration"
              class="form-control"
              required
            >
          </div>
        </div>
        
        <div class="form-group">
          <label for="description">
            Description <span class="required">*</span>
          </label>
          <textarea 
            id="description" 
            [(ngModel)]="moduleData.description"
            placeholder="Enter Description"
            rows="4"
            class="form-control"
            required
          ></textarea>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="videoFile">
              Video
            </label>
            
            <div class="file-upload">
              <input 
                type="file" 
                id="videoFile" 
                accept=".mp4,.mov,.avi,.webm" 
                (change)="onVideoFileChange($event)" 
                class="file-input"
              >
              <div class="file-upload-button">Choose New File</div>
              <div class="file-name">{{ videoFileName }}</div>
              <button 
                *ngIf="videoFile || existingVideoPath" 
                type="button" 
                class="btn btn-sm btn-outline-danger ms-2"
                (click)="clearVideoFile()"
              >
                Clear
              </button>
            </div>
            
            <div class="file-info">
              <small class="text-muted">
                Upload only MP4, MOV, AVI, or WEBM files. Max size: 100MB
                <span *ngIf="existingVideoPath && !videoFile" class="text-info">
                  <br>Current: {{ extractFileName(existingVideoPath) }}
                </span>
              </small>
            </div>
            
            <div *ngIf="videoError" class="error-message text-danger mt-1">
              {{ videoError }}
            </div>
  
            <!-- Video Preview -->
            <div *ngIf="videoPreview" class="mt-2">
              <video [src]="videoPreview" controls class="preview-video" style="max-width: 300px; height: auto;">
                Your browser does not support the video tag.
              </video>
            </div>
          </div>
          
          <div class="form-group">
            <label for="pdfFile">
              PDF Document
            </label>
            
            <div class="file-upload">
              <input 
                type="file" 
                id="pdfFile" 
                accept=".pdf" 
                (change)="onPdfFileChange($event)" 
                class="file-input"
              >
              <div class="file-upload-button">Choose New File</div>
              <div class="file-name">{{ pdfFileName }}</div>
              <button 
                *ngIf="pdfFile || existingPdfPath" 
                type="button" 
                class="btn btn-sm btn-outline-danger ms-2"
                (click)="clearPdfFile()"
              >
                Clear
              </button>
            </div>
            
            <div class="file-info">
              <small class="text-muted">
                Upload only PDF files. Max size: 20MB
                <span *ngIf="existingPdfPath && !pdfFile" class="text-info">
                  <br>Current: {{ extractFileName(existingPdfPath) }}
                </span>
              </small>
            </div>
            
            <div *ngIf="pdfError" class="error-message text-danger mt-1">
              {{ pdfError }}
            </div>
          </div>
        </div>
  
        <!-- Action Buttons -->
        <div class="form-actions mt-4 d-flex gap-2">
          <button 
            type="button" 
            class="btn btn-success btn-lg px-4" 
            (click)="onSubmit()"
            [disabled]="isSubmitting || !moduleData.name || !moduleData.duration || !moduleData.description"
          >
            <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            {{ isSubmitting ? 'Updating Module...' : 'Update Module' }}
          </button>
          
          <button 
            type="button" 
            class="btn btn-outline-secondary btn-lg px-4"
            (click)="onCancel()"
            [disabled]="isSubmitting"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <style>
  .module-form {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
  }
  
  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }
  
  .form-group {
    margin-bottom: 20px;
  }
  
  .form-group label {
    font-weight: 600;
    margin-bottom: 8px;
    display: block;
  }
  
  .required {
    color: #dc3545;
  }
  
  .file-upload {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background-color: #f8f9fa;
  }
  
  .file-input {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }
  
  .file-upload-button {
    background-color: #007bff;
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }
  
  .file-upload-button:hover {
    background-color: #0056b3;
  }
  
  .file-name {
    flex: 1;
    font-size: 14px;
    color: #666;
  }
  
  .file-info {
    margin-top: 4px;
    font-size: 12px;
    color: #6c757d;
  }
  
  .error-message {
    font-size: 12px;
    margin-top: 4px;
  }
  
  .form-actions {
    border-top: 1px solid #eee;
    padding-top: 24px;
  }
  
  @media (max-width: 768px) {
    .form-row {
      grid-template-columns: 1fr;
    }
    
    .form-actions {
      flex-direction: column;
    }
    
    .form-actions .btn {
      width: 100%;
    }
  }
  </style>