<!-- Header Component -->
<app-mainheader
[userName]="user.userName"
[userEmail]="user.userEmail"
[userAvatar]="user.userAvatar">
</app-mainheader>

<!-- Main Content -->
<main class="categories-page">
  <div class="container">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Explore Categories</h1>
      <p class="page-subtitle">Discover courses across a wide range of subjects.</p>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
      <p class="loading-text">Loading categories...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
      <div class="error-content">
        <i class="fas fa-exclamation-circle error-icon"></i>
        <h3 class="error-title">Something went wrong</h3>
        <p class="error-message">{{ error }}</p>
        <button class="btn btn-retry" (click)="loadCategories()">
          <i class="fas fa-redo me-2"></i>Try Again
        </button>
      </div>
    </div>

    <!-- Categories Grid -->
    <div *ngIf="!loading && !error && categories && categories.length > 0" class="categories-grid">
      <div class="category-card" 
           *ngFor="let category of categories; trackBy: trackByCategory"
           (click)="viewCategoryCourses(category.id, category.name)"
           role="button"
           tabindex="0"
           (keydown.enter)="viewCategoryCourses(category.id, category.name)"
           (keydown.space)="viewCategoryCourses(category.id, category.name)">
        
        <div class="card-image" [style.background-image]="getCategoryImageStyle(category)">
          <!-- Fallback icon if image fails to load -->
          <div class="category-icon" *ngIf="!category.imagePath">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <!-- Image error handling -->
          <img 
            *ngIf="category.imagePath" 
            [src]="category.imagePath" 
            [alt]="category.name"
            class="category-img"
            (error)="onImageError($event)"
            (load)="onImageLoad($event)">
        </div>
        
        <div class="card-content">
          <h3 class="category-name">{{ category.name }}</h3>
          <div class="course-count" *ngIf="category.courseCount">
            {{ category.courseCount }} course{{ category.courseCount !== 1 ? 's' : '' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && (!categories || categories.length === 0)" class="empty-state">
      <div class="empty-content">
        <i class="fas fa-folder-open empty-icon"></i>
        <h3 class="empty-title">No Categories Available</h3>
        <p class="empty-message">We're working on adding new categories. Please check back later.</p>
        <button class="btn btn-primary" (click)="loadCategories()">
          <i class="fas fa-refresh me-2"></i>Refresh
        </button>
      </div>
    </div>
  </div>
</main>

<!-- Footer Component -->
<app-mainfooter></app-mainfooter>